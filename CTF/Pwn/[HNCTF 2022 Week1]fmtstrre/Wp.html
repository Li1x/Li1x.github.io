<p>先checksec一下</p>
<p><img src="/Wp/00.png"></p>
<p>然后IDA(64)打开</p>
<p><img src="/Wp/01.png"></p>
<blockquote>
<p>open函数(成功打开文件返回非负整数，打开失败返回-1)</p>
<p>read(fd, &amp;name, 48uLL)函数(向fd中读取48字节数据存放至name地址下)</p>
<p>将name的地址赋值给v5</p>
<p>再向buf中写入256字节数据</p>
</blockquote>
<p>格式化字符串漏洞点 <code>printf(buf)</code></p>
<p>这段代码中需要打开flag这个文件 &#x3D;l&gt; 小技巧</p>
<p>-&gt; 在当前目录下创建一个flag文件，并输入一些东西，可以帮助我们观察其在栈上的位置。</p>
<p>-&gt;当然,这个文件不是必须的.</p>
<p>该如何利用这个漏洞？根据这个题，flag这个文件的内容是存放在了栈中，那我们就要知道具体的位置。</p>
<p>-&gt;偏移量的计算（看别人的Wp说是偏移了38）即flag 的内容是保存在第38个的位置上的</p>
<p><strong>参考<a href="https://www.cnblogs.com/falling-dusk/p/17858030.html">https://www.cnblogs.com/falling-dusk/p/17858030.html</a></strong></p>
<p><img src="/Wp/02.png"></p>
<blockquote>
<p>找 …4141… 类似的数据，看它是第几个地址（6）</p>
</blockquote>
<p><img src="/Wp/03.png"></p>
<blockquote>
<p>name即flag的位置，0x20 &#x3D;32 &#x3D;&gt;偏移量.</p>
<p>rsp到name的距离是 0x1d0 - 0x0d0 &#x3D; 256 &#x2F; 8 &#x3D;32</p>
<p>​	对于这里要除以8 —&gt; 我理解的是（64位程序，栈中一个小格格是8字节数据，一共相差256字节，即32个小格子）</p>
</blockquote>
<p>32 + 6 &#x3D;38</p>
<p><strong>exp:</strong></p>
<pre><code class="python">from pwn import *
io = remote()
payload = &quot;%38$s&quot;
io.sendline(payload)
io.interactive()
</code></pre>
